import React,{useState,useEffect} from "react";
import 'bootstrap/dist/css/bootstrap.min.css'; 
import Comment from "../components/Comment";
import { GrAttachment } from "react-icons/gr";
import { AiOutlineEye,AiFillWechat } from "react-icons/ai";
import { BiDownvote,BiUpvote, } from "react-icons/bi";
import {Button,Container} from 'react-bootstrap';
import { api } from "../api";


export default function ViewPost({post,user}){
    const [upvotes,setUpvotes] = useState(post.upvotes);
    const [comment, setComment] = useState("");
    const [prevComments,setPrevComments]= useState([]);

   
    const handleUpvote = () => {
    setUpvotes(upvotes+1);
    }

    const handleDownvote = () => {
        if(upvotes !== 0) setUpvotes(upvotes-1);
        else setUpvotes(0);
    }
    
    const addComment = async () => {
        if (comment.trim().length === 0) {
          return;
        }
        const comment = {
          user_id:user.user_id,
          content: comment,
        };
    
        // try {
        //   await api.postMessage(message);
        //   getUserMessages();
        //   getClickedUserMessages();
        //   setComment("");
        // } catch (e) {
        //   console.log(e);
        // }
      };
    return(
        <div className=" m-auto max-w-[640px] w-[420px] md:w-[480px] lg:w-[560px]">
            <div className="m-auto mt-5 max-w-[580px] w-[360px] md:w-[420px] lg:w-[540px]">
                <Container className = "justify-center">
                <h4>{post.title}</h4>
                <p  className="mb-2 text-muted">{post.hashes}</p>
                <p>{post.content}</p>
                <p style = {{color: "#004581",fontWeight: "500"}}>{upvotes} Upvotes</p>
                <div className="mb-2">
                    <Button variant="outline-secondary"  style = {{color: "black",marginRight: "4px" ,display: "inline-flex"}}><span><AiOutlineEye /></span> View collaboarations</Button>
                    <Button variant="outline-secondary" style = {{color: "black",display: "inline-flex"}}><GrAttachment /> View attachments</Button>
                </div>
                <div className="mb-2">
                    <Button  onClick={handleUpvote()} style = {{marginRight: "4px", backgroundColor: '#004581',color: "white",display: "inline-flex"}} ><BiUpvote />Upvote</Button>
                    <Button  onClick = {handleDownvote()} style = {{backgroundColor: '#004581',color: "white",display: "inline-flex"}}> <BiDownvote />Downvote</Button>
                </div>
                <Button style = {{backgroundColor: '#018ABD',color: "white",display: "inline-flex"}}><AiFillWechat/>Collaborate</Button>
                </Container>
            </div>
            <div  className="flex flex-row" >
            <input
                id = "comment_input"
                value = {comment}
                onChange={(e) => setComment(e.target.value)}
                placeholder = "New Comment..."
                className="p-2 w-[100%] my-5 resize-none focus:outline-none h-12 border-slate-700 border-opacity-20 border"
            />
            <button
                onClick={addComment}
                className="text-white bg-[#0287BF] px-2 py-1 md:px-3 md:py-2 m-2 rounded-full font-semibold w-fit text-lg md:text-xl cursor-pointer hover:bg-[#97CBDC] hover:text-[#0287BF] border-1 border-[#fe5740]"
            >Comment</button>
            </div>
            <Comment /> 
        </div>
    );
}